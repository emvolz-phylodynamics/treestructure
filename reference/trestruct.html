<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect cryptic population structure in time trees — trestruct • treestructure</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect cryptic population structure in time trees — trestruct"><meta name="description" content="Estimates a partition of a time-scaled tree by contrasting coalescent patterns."><meta property="og:description" content="Estimates a partition of a time-scaled tree by contrasting coalescent patterns."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">treestructure</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/treestructure.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/supportValues.html">Node support values</a></li>
    <li><a class="dropdown-item" href="../articles/updating_treestructure.html">Updating a treestructure object</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/emvolz-phylodynamics/treestructure/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detect cryptic population structure in time trees</h1>
      <small class="dont-index">Source: <a href="https://github.com/emvolz-phylodynamics/treestructure/blob/master/R/m13.R" class="external-link"><code>R/m13.R</code></a></small>
      <div class="d-none name"><code>trestruct.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates a partition of a time-scaled tree by contrasting coalescent patterns.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">trestruct</span><span class="op">(</span></span>
<span>  <span class="va">tre</span>,</span>
<span>  minCladeSize <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  minOverlap <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>,</span>
<span>  nodeSupportValues <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nodeSupportThreshold <span class="op">=</span> <span class="fl">95</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  ncpu <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbosity <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  debugLevel <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  levellb <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  levelub <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  res <span class="op">=</span> <span class="fl">11</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tre">tre<a class="anchor" aria-label="anchor" href="#arg-tre"></a></dt>
<dd><p>A tree of type ape::phylo. Must be rooted. If the tree has multifurcations,
it will be converted to a binary tree before processing.</p></dd>


<dt id="arg-mincladesize">minCladeSize<a class="anchor" aria-label="anchor" href="#arg-mincladesize"></a></dt>
<dd><p>All clusters within partition must have at least this many
tips.</p></dd>


<dt id="arg-minoverlap">minOverlap<a class="anchor" aria-label="anchor" href="#arg-minoverlap"></a></dt>
<dd><p>Threshold time overlap required to find splits in a clade.</p></dd>


<dt id="arg-nodesupportvalues">nodeSupportValues<a class="anchor" aria-label="anchor" href="#arg-nodesupportvalues"></a></dt>
<dd><p>Node support values such as produced by bootstrap or
Bayesian credibility scores. Must be logical or vector with length equal
to number of internal nodes in the tree. If nodeSupportValues = TRUE, then
the function will get the information on node support from the tree.
If numeric vector, these values should be between 0 and 100.</p></dd>


<dt id="arg-nodesupportthreshold">nodeSupportThreshold<a class="anchor" aria-label="anchor" href="#arg-nodesupportthreshold"></a></dt>
<dd><p>Threshold node support value between 0 and 100.
Nodes with support lower than this threshold will not be tested.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>Number of simulations for computing null distribution of test
statistics.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Significance level for finding new split within a set of tips.
Can also be NULL, in which case the optimal level is found according to the
CH index (see details).</p></dd>


<dt id="arg-ncpu">ncpu<a class="anchor" aria-label="anchor" href="#arg-ncpu"></a></dt>
<dd><p>If &gt; 1 will compute statistics in parallel using multiple CPUs.</p></dd>


<dt id="arg-verbosity">verbosity<a class="anchor" aria-label="anchor" href="#arg-verbosity"></a></dt>
<dd><p>If &gt; 0 will print information about progress of the algorithm.</p></dd>


<dt id="arg-debuglevel">debugLevel<a class="anchor" aria-label="anchor" href="#arg-debuglevel"></a></dt>
<dd><p>If &gt; 0 will produce additional data in return value.</p></dd>


<dt id="arg-levellb">levellb<a class="anchor" aria-label="anchor" href="#arg-levellb"></a></dt>
<dd><p>If optimizing the `level` parameter, this is the lower bound
for the search.</p></dd>


<dt id="arg-levelub">levelub<a class="anchor" aria-label="anchor" href="#arg-levelub"></a></dt>
<dd><p>If optimizing the `level` parameter, this is the upper bound
for the search.</p></dd>


<dt id="arg-res">res<a class="anchor" aria-label="anchor" href="#arg-res"></a></dt>
<dd><p>If optimizing the `level` parameter, this is the number of values
to test.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A TreeStructure object which includes cluster and partition assignment
   for each tip of the tree.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Estimates a partition of a time-scaled tree by contrasting coalescent patterns.
The algorithm is premised on a Kingman coalescent null hypothesis for the
ordering of node heights when contrasting two clades, and a test statistic is
formulated based on the rank sum of node times in the tree.
If node support values are available (as computed by bootstrap procedures),
the method can optionally exclude designation of structure on poorly supported
nodes. The method will not designate structure on nodes with zero branch length
relative to their immediate ancestor.
The significance level for detecting significant partitions of the tree can be
provided, or a range of values can be examined.
The <a href="https://en.wikipedia.org/wiki/Calinski-Harabasz_index" class="external-link">CH index</a>
based on within- and between-cluster variance in node heights can be used to
select a significance level if none is provided.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Volz EM, Carsten W, Grad YH, Frost SDW, Dennis AM, Didelot X.
<a href="https://academic.oup.com/sysbio/article/69/5/884/5734655?login=false" class="external-link">Identification of hidden population structure in time-scaled phylogenies.</a>
Systematic Biology 2020; 69(5):884-896.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Erik M Volz</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">ape</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rcoal</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">struct</span> <span class="op">&lt;-</span>  <span class="fu">trestruct</span><span class="op">(</span> <span class="va">tree</span> <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Finding splits under nodes: 51 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">struct</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> .trestruct(tre = tre, minCladeSize = minCladeSize, minOverlap = minOverlap, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nodeSupportValues = nodeSupportValues, nodeSupportThreshold = nodeSupportThreshold, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nsim = nsim, level = level[1], ncpu = ncpu, verbosity = verbosity, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     debugLevel = debugLevel, useNodeSupport = useNodeSupport, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     tredat = tredat)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Significance level: 0.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of clusters: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of partitions: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of taxa in each cluster:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of taxa in each partition:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> For complete data, use `as.data.frame(...)` </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>
Website developed by <a href="https://profiles.imperial.ac.uk/f.ferreira-do-nascimento" class="external-link">Fabricia F. Nascimento</a>
</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

